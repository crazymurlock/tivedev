<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
</head>
<body>
<!-- partial:index.partial.html -->
<div><canvas width="640" height="480" /></div>

<!--

WebGL CRT monitor effect demo with a tiny surprise. Uses offscreen 2D canvas as buffer source.

Libraries and sources:

- ReGL (WebGL helper): http://regl.party/
- glMatrix (math): http://glmatrix.net/
- onecolor (RGB conversion): https://github.com/One-com/one-color
- Google Fonts Inconsolata
- Renminbi by Fengquan Li from the Noun Project
- Skull by Jordan Alfarishy from the Noun Project
- bunny by Smalllike from the Noun Project
- dollar by Oksana Latysheva from the Noun Project

-->
<!-- partial -->
  <script src='https://npmcdn.com/regl@1.3.9/dist/regl.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/gl-matrix/2.7.1/gl-matrix-min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/onecolor/3.1.0/one-color-all.js'></script><script  src="./script.js"></script>

</body>
 var input = `
Salam biz TİV agency:...................................(  OK  )
İnteraktiv.................................(  OK  )
Kreattiv........................(  OK  )
İnnovativ.....................(  OK  )
Biz nə təklif edirik?..........................( OK )
Web və Android/IOS APPLAR.................(  OK  )
QR/AR Həllər.................(  OK  )
Chatbotlar və s....................(  OK  )
`.trim();

var term = $('body').terminal(function() {
    return this.animation(async () => {
        var lines = input.split('\n');
        this.set_prompt('');
        for (let line of lines) {
            var parts = line.split(/(\.+)/);
            await this.typing('echo', 50, parts[1], { prompt: parts[0] });
            //await this.set_prompt(parts[0]).typing('enter', 50, parts[1]);
            this.update(-1, line);
            await this.delay(1000);
        }
        this.set_prompt('> ');
    });
}, {
    greetings: 'nə ilə məşqul olmağımızı ENTER basıb baxın',
    keydown: () => animation ? false : undefined
});

$.terminal.new_formatter([/(\(\s+)OK(\s+\))/g, '$1[[;green;]OK]$2']);
$.terminal.new_formatter([/(\(\s+)FAIL(\s+\))/g, '$1[[;red;]FAIL]$2']);

var animation;
// INTERNALS TODO
(function() {
    function is_promise(object) {
        return object && typeof object === 'object' && typeof object.then === 'function';
    }

    function unpromise(value, fn) {
        if (is_promise(value)) {
            return value.then(fn);
        }
        return fn(value);
    }
    $.fn.animation = function(fn) {
        if (typeof fn === 'function') {
            animation = true;
            return unpromise(fn(), function() {
                animation = false;
            });
        }
    };
    $.fn.delay = function delay(timeout) {
        return new Promise(resolve => {
            setTimeout(resolve, timeout);
        });
    };
})();


</html>
